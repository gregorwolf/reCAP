/*!
* OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/registry/ChangeRegistry","sap/ui/fl/changeHandler/AddXML","sap/ui/fl/changeHandler/AddXMLAtExtensionPoint","sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/MoveControls","sap/ui/fl/changeHandler/MoveElements","sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/fl/changeHandler/PropertyChange","sap/ui/fl/changeHandler/StashControl","sap/ui/fl/changeHandler/UnhideControl","sap/ui/fl/changeHandler/UnstashControl"],function(e,n,a,r,i,s,t,d,l,o,g,h){"use strict";var f={hideControl:i,moveElements:t,moveControls:s,stashControl:o,unhideControl:g,unstashControl:h};var u={addXML:a,addXMLAtExtensionPoint:r,propertyBindingChange:d,propertyChange:l};var C={getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs:function(){var e=sap.ui.getCore();var n=e.getLoadedLibraries();var a=[];Object.values(n).forEach(function(e){if(e.extensions&&e.extensions.flChangeHandlers){a.push(this._registerFlexChangeHandlers(e.extensions.flChangeHandlers))}}.bind(this));e.attachLibraryChanged(this._handleLibraryRegistrationAfterFlexLibraryIsLoaded.bind(this));return Promise.all(a)},_registerFlexChangeHandlers:function(n){if(n){return e.registerChangeHandlersForLibrary(n)}return Promise.resolve()},_handleLibraryRegistrationAfterFlexLibraryIsLoaded:function(e){if(e.getParameter("operation")==="add"){var a=e.getParameter("metadata");var r=a.sName;if(a&&a.extensions&&a.extensions.flChangeHandlers){var i=a.extensions.flChangeHandlers;var s=this._registerFlexChangeHandlers(i);n.addRegistrationPromise(r,s);return s}}return Promise.resolve()},registerPredefinedChangeHandlers:function(){n.getInstance().registerPredefinedChangeHandlers(f,u);e.registerPredefinedChangeHandlers(f,u)}};return C});