/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/ParseException","sap/ui/model/ValidateException"],function(t,i){"use strict";var e=new Map,n=/\.(\d+)$/,s=/\.$/,r=/0+$/;function o(t,i){return sap.ui.getCore().getLibraryResourceBundle().getText(t,i)}function u(t){if(this.mCustomUnits===undefined){throw new i("Cannot validate value without customizing")}}return function(i,a,m){function p(t,i){var n,s=this;if(this.mCustomUnits===undefined&&t&&t[2]!==undefined){if(t[2]===null){this.mCustomUnits=null}else{this.mCustomUnits=e.get(t[2]);if(!this.mCustomUnits){this.mCustomUnits={};Object.keys(t[2]).forEach(function(i){s.mCustomUnits[i]=s.getCustomUnitForKey(t[2],i)});e.set(t[2],this.mCustomUnits)}n={};n[m]=this.mCustomUnits;a.prototype.setFormatOptions.call(this,Object.assign(n,this.oFormatOptions))}}if(!t||t[0]===undefined||t[1]===undefined||this.mCustomUnits===undefined&&t[2]===undefined){return null}return a.prototype.formatValue.call(this,t.slice(0,2),i)}function h(){var t=a.prototype.getFormatOptions.call(this);t.parseAsString=this.bParseAsString;delete t[m];return t}function l(){if(this.oFormatOptions.showMeasure===false){return[1,2]}return[2]}function f(i,e,u){var m,p,h,l,f;if(this.mCustomUnits===undefined){throw new t("Cannot parse value without customizing")}f=a.prototype.parseValue.apply(this,arguments);l=f[1]||u[1];if(f[0].includes(".")){f[0]=f[0].replace(r,"").replace(s,"")}if(l&&this.mCustomUnits){if(!this.mCustomUnits[l]){throw a.prototype._createInvalidUnitParseException()}h=n.exec(f[0]);p=h?h[1].length:0;m=this.mCustomUnits[l].decimals;if(p>m){throw new t(m?o("EnterNumberFraction",[m]):o("EnterInt"))}}if(!this.bParseAsString){f[0]=Number(f[0])}return f}function c(t,i){if(t&&t[m]){throw new Error("Format option "+m+" is not supported")}if(i){throw new Error("Constraints not supported")}if(arguments.length>2){throw new Error("Only the parameter oFormatOptions is supported")}this.bParseAsString=!t||!("parseAsString"in t)||t.parseAsString;t=Object.assign({unitOptional:true,emptyString:0},t,{parseAsString:true});a.call(this,t,i);this.mCustomUnits=undefined;this.bParseWithValues=true;this.setConstraints=function(){throw new Error("Constraints not supported")};this.setFormatOptions=function(){throw new Error("Format options are immutable")}}i._applyUnitMixin=c;i.formatValue=p;i.getFormatOptions=h;i.getPartsIgnoringMessages=l;i.parseValue=f;i.validateValue=u}},false);