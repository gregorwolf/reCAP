/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/support/library","sap/ui/fl/Utils","sap/ui/dt/DesignTime","sap/ui/core/Component","sap/ui/fl/registry/ChangeRegistry","sap/ui/rta/util/validateStableIds","sap/base/util/ObjectPath","sap/m/InstanceManager"],function(e,t,n,a,o,i,r,s){"use strict";var l=e.Categories;var c=e.Audiences;var u=e.Severity;function p(e){var n;e.some(function(e){n=t.getAppComponentForControl(e);return!!n});return n}function d(e){return(!e.isPopupAdaptationAllowed||e.isPopupAdaptationAllowed())&&t.getAppComponentForControl(e)&&(e.isA("sap.m.Dialog")||e.isA("sap.m.Popover"))}var f={id:"stableId",audiences:[c.Application],categories:[l.Functionality],enabled:true,minversion:"1.28",title:"Stable control IDs are required for SAPUI5 flexibility services",description:"Checks whether the IDs of controls support SAPUI5 flexibility services",resolution:"Replace the generated control ID with a stable ID. We strongly recommend that you use stable IDs for all controls in your app.",resolutionurls:[{text:"Documentation: Stable IDs: All You Need to Know",href:"https://sapui5.hana.ondemand.com/#topic/f51dbb78e7d5448e838cdc04bdf65403"}],async:true,check:function(e,t,a,o){var l;var c=r.get("sap.ushell.Container");if(c){var f=c.getService("AppLifeCycle").getCurrentApplication();if(!f.homePage){l=f.componentInstance}}else{l=p(a.getElements())}if(!l){return}var h=s.getOpenPopovers();var g=s.getOpenDialogs();var v=h.concat(g).filter(d);var m=new n({rootElements:[l].concat(v)});m.attachEventOnce("synced",function(){var t=i(m.getElementOverlays(),l);t.forEach(function(t){var n=t.getElement();var a=n.getId();var o=a.includes("--");if(!o){e.addIssue({severity:u.High,details:"The ID '"+a+"' for the control was generated and flexibility features "+"cannot support controls with generated IDs.",context:{id:a}})}else{e.addIssue({severity:u.Low,details:"The ID '"+a+"' for the control was concatenated and has a generated onset.\n"+"To enable the control for flexibility features, you must specify an ID for the control providing the onset, which is marked as high issue.",context:{id:a}})}});m.destroy();o()})}};return{name:"sap.ui.fl",niceName:"UI5 Flexibility Library",ruleset:[f]}},true);