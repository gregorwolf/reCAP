/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/BackendConnector","sap/ui/fl/initial/_internal/connectors/KeyUserConnector","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils"],function(n,e,t,r,i){"use strict";var s="/flex/keyuser";var a="/v1";function o(n){n.initialConnector=t;n.xsrfToken=t.xsrfToken;n.tokenUrl=l.ROUTES.TOKEN}function u(n){var e={title:n.title};n.payload=JSON.stringify(e);n.dataType="json";n.contentType="application/json; charset=utf-8"}function c(n){n.version=n.versionNumber;delete n.versionNumber;return n}var l=n({},e,{layers:t.layers,ROUTES:{CHANGES:s+a+"/changes/",SETTINGS:s+a+"/settings",TOKEN:s+a+"/settings",VERSIONS:{GET:s+a+"/versions/",ACTIVATE:s+a+"/versions/activate/",DISCARD:s+a+"/versions/draft/"}},isLanguageInfoRequired:true});l.versions={load:function(n){o(n);var e={};r.addLanguageInfo(e);e.limit=n.limit;var t=r.getUrl(l.ROUTES.VERSIONS.GET,n,e);return r.sendRequest(t,"GET",n).then(function(n){return n.response.map(function(n){return c(n)})})},activate:function(n){o(n);u(n);var e={version:n.version};r.addLanguageInfo(e);var t=r.getUrl(l.ROUTES.VERSIONS.ACTIVATE,n,e);return i.sendRequest(t,"POST",n).then(function(n){var e=n.response;return c(e)})},discardDraft:function(n){o(n);var e=r.getUrl(l.ROUTES.VERSIONS.DISCARD,n);return i.sendRequest(e,"DELETE",n)}};l.initialConnector=t;return l},true);